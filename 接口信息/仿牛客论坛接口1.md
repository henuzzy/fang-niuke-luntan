## 1. 用户接口

### 1.1 用户注册
> 请求路径：/users/register
> 
> 请求方式：POST
> 
> 接口描述：用户注册，输入账号、密码、确认密码和邮箱，后台进行校验，注册成功后发送激活邮件。


请求参数

参数格式：application/json

| 参数名         | 类型      | 是否必须 | 备注                           |
| -------------- | ------ | -------- | ------------------------------ |
| username           | string | 必须     | 用户名 |
| password           | string | 必须     | 密码 |
| confirmPwd           | string | 必须     | 确认密码 |
| email           | string | 必须     | 邮箱 |


请求样例

```json

{
    "username": "xiaoming",
    "password": "123456",
    "confirmPwd": "123456",
    "email": "test@nowcoder.com"
}
```

响应参数
| 参数名         | 类型      | 是否必须 | 备注                           |
| -------------- | ------ | -------- | ------------------------------ |
| code           | number | 必须     | 响应码，1 表示成功，0 表示失败 |
| msg           | string | 非必须     | 提示信息 |
| data           | object | 非必须     | 返回的数据 |


响应样例

```json
{
    "code": 1,
    "msg": "注册成功",
    "data": null
}

{
    "code": 0,
    "msg": "两次输入的密码不一致",
    "data": null
}

{
    "code": 0,
    "msg": "该用户名已被注册",
    "data": null
}
```

### 1.2 用户登录

> 请求路径：/users/login
> 
> 请求方式：POST
> 
> 接口描述：用于用户登录校验，成功后返回登录凭证（ticket），支持“记住我”功能。

请求参数

| 参数名         | 类型      | 是否必须 | 备注                           |
| -------------- | ------ | -------- | ------------------------------ |
| username           | string | 必须     | 用户名 |
| password           | string | 必须     | 密码 |
| captcha           | string | 必须     | 图形验证码（与后端生成的验证码进行校验） |
| rememberMe           | bool | 否     | 是否记住我，true = 有效期 30 天，false = 12 小时 |

请求样例
```json

{
    "username": "xiaoming",
    "password": "12345678",
    "captcha": "YW37",
    "rememberMe": true
}
```


响应参数

| 参数名         | 类型      | 是否必须 | 备注                           |
| -------------- | ------ | -------- | ------------------------------ |
| code           | number | 必须     | 1 表示成功，0 表示失败 |
| msg           | string | 非必须     | 提示信息 |
| data           | object | 非必须     | 返回的数据 |



响应样例

```json

{
    "code": 1,
    "msg": "登录成功",
    "data": {
        "ticket": "abccdefg12345",
        "expired": "2022-09-01T23:06:29"
    }
}

{
    "code": 0,
    "msg": "账号不存在",
    "data": null
}

{
    "code": 0,
    "msg": "密码错误",
    "data": null
}

{
    "code": 0,
    "msg": "验证码不正确",
    "data": null
}
```

## 2. 帖子接口

### 2.1 查询帖子列表（首页）

> 请求路径：/posts
> 
> 请求方式：GET
> 
> 接口描述：分页查询帖子列表（可按最新/最热排序）

请求参数

| 参数名         | 类型      | 是否必须 | 备注                           |
| -------------- | ------ | -------- | ------------------------------ |
| page           | number | 否     | 页码，默认 1 |
| pageSize           | number | 否     | 每页显示数量，默认 10 |
| order           | string | 否     | 排序规则：latest/hot |


请求例子：/posts?page=1&pageSize=10&order=hot

响应样例

```json

{
    "code": 1,
    "msg": "success",
    "data": {
        "total": 2,
        "rows": [
            {
                "id": 1,
                "title": "备战春招，面试刷题跟他复习",
                "content": "一个月全搞定！",
                "userId": 101,
                "createTime": "2019-04-15T15:32:18",
                "commentCount": 7,
                "likeCount": 11,
                "type": 1,
                "status": 1
            }
        ]
    }
}
```

### 2.2 发布帖子

> 请求路径：/posts
> 
> 请求方式：POST
> 
> 接口描述：发帖

请求参数

| 参数名         | 类型      | 是否必须 | 备注                           |
| -------------- | ------ | -------- | ------------------------------ |
| title           | string | 必须     | 标题 |
| content           | string | 必须     | 内容 |


请求样例

```json

{
    "title": "春招复习分享",
    "content": "刷题学习经验总结"
}
```

响应样例

```json

{
    "code": 1,
    "msg": "发布成功",
    "data": null
}
```

### 2.3 分页查询帖子列表

> 请求路径：/posts
> 
> 请求方式：GET
> 
> 接口描述：分页获取帖子列表，支持跳转到首页、上一页、下一页、末页等功能。

请求参数

参数格式：queryString

| 参数名         | 类型      | 是否必须 | 备注                           |
| -------------- | ------ | -------- | ------------------------------ |
| page           | number | 否     | 页码，默认 1 |
| pageSize           | number | 否     | 内容 |
| page           | number | 否     | 页码，默认 1 |
| order           | string | 否     | 排序规则：latest（最新），hot（最热） |


请求样例

/posts?page=1&pageSize=10&order=latest
/posts?page=3&pageSize=5&order=hot

响应参数

参数名	类型	是否必须	备注
code	number	必须	响应码
msg	string	非必须	提示信息
data	object	必须	返回的数据
- total	number	必须	帖子总数
- pages	number	必须	总页数
- page	number	必须	当前页码
- rows	object[]	必须	帖子列表数据


响应样例

```json

{
  "code": 1,
  "msg": "success",
  "data": {
    "total": 52,
    "pages": 6,
    "page": 2,
    "rows": [
      {
        "id": 11,
        "title": "备战春招面试复习总结",
        "content": "一个月搞定复习计划！",
        "userId": 101,
        "createTime": "2019-04-15T15:32:18",
        "commentCount": 5,
        "likeCount": 20,
        "type": 1,
        "status": 1
      },
      {
        "id": 12,
        "title": "算法刷题打卡",
        "content": "每天两题，坚持就是胜利",
        "userId": 102,
        "createTime": "2019-04-16T14:12:00",
        "commentCount": 3,
        "likeCount": 8,
        "type": 0,
        "status": 0
      }
    ]
  }
}
```

### 2.4 查询帖子详情

> 请求路径：/posts/{postId}
> 
> 请求方式：GET
> 
> 接口描述：根据帖子 ID 查询帖子详情，包括帖子基本信息、作者信息、评论列表。

请求参数

| 参数名         | 类型      | 是否必须 | 备注                           |
| -------------- | ------ | -------- | ------------------------------ |
| postId           | number | 必须     | 帖子 ID |


响应参数

| 参数名         | 类型      | 是否必须 | 备注                           |
| -------------- | ------ | -------- | ------------------------------ |
| code           | number | 必须     | 1 成功，0 失败 |
| msg           | string | 非必须     | 提示信息 |
| data           | object | 必须     | 返回的帖子详情数据 |

data	object	必须	返回的帖子详情数据
- post	object	必须	帖子基本信息
- author	object	必须	作者信息
- comments	object[]	必须	评论列表

响应样例

```json

{
  "code": 1,
  "msg": "success",
  "data": {
    "post": {
      "id": 1,
      "title": "备战春招，面试刷题跟他复习，一个月全搞定！",
      "content": "金三银四的金三已经到了，你还沉浸在过年的喜悦中吗？...",
      "createTime": "2019-04-15T15:32:18",
      "commentCount": 30,
      "likeCount": 11,
      "status": 0,
      "type": 1
    },
    "author": {
      "id": 101,
      "username": "寒江雪",
      "headerUrl": "http://images.nowcoder.com/head/101.png"
    },
    "comments": [
      {
        "id": 1001,
        "userId": 102,
        "username": "掉脑袋切切切",
        "content": "这开课时间是不是有点晚啊...",
        "createTime": "2019-04-15T15:40:00",
        "likeCount": 1,
        "replies": [
          {
            "id": 2001,
            "userId": 103,
            "username": "小昭",
            "content": "确实有点晚，不过还能赶上",
            "createTime": "2019-04-15T15:45:00",
            "likeCount": 2
          }
        ]
      }
    ]
  }
}
```

### 2.5 点赞帖子

> 请求路径：/posts/{postId}/like
> 
> 请求方式：POST
> 
> 接口描述：对指定帖子进行点赞或取消点赞（根据当前用户的点赞状态切换）。

请求参数
| 参数名         | 类型      | 是否必须 | 备注                           |
| -------------- | ------ | -------- | ------------------------------ |
| postId           | number | 必须     | 帖子ID |


响应样例

```json

{
  "code": 1,
  "msg": "success",
  "data": {
    "likeCount": 12,
    "likeStatus": 1
  }
}

说明：likeStatus=1 表示已点赞；likeStatus=0 表示未点赞。

```


### 2.6 评论帖子

> 请求路径：/posts/{postId}/comments
> 
> 请求方式：POST
> 
> 接口描述：对指定帖子发表评论。

请求参数
| 参数名         | 类型      | 是否必须 | 备注                           |
| -------------- | ------ | -------- | ------------------------------ |
| postId           | number | 必须     | 帖子ID |
| content           | string | 必须     | 评论内容 |


请求样例

```json

{
  "content": "这分享太实用了，点赞！"
}
```

响应样例

```json

{
  "code": 1,
  "msg": "评论发布成功",
  "data": {
    "commentId": 501,
    "content": "这分享太实用了，点赞！",
    "createTime": "2019-04-15T16:12:00"
  }
}
```



## 3. 消息接口

### 3.1 查询私信列表

> 请求路径：/messages
> 
> 请求方式：GET
> 
> 接口描述：查询用户的私信会话列表

响应样例

```json

{
    "code": 1,
    "msg": "success",
    "data": [
        {
            "conversationId": "101_102",
            "fromId": 101,
            "toId": 102,
            "content": "你好！",
            "createTime": "2019-04-15T16:32:18",
            "status": 0
        }
    ]
}
```


## 4. 用户下拉菜单接口

### 4.1 查看个人主页

> 请求路径：/users/{userId}/profile
> 
> 请求方式：GET
> 
> 接口描述：根据用户ID查看个人主页信息（包括基本资料、发帖数、评论数、点赞数等）

请求参数
| 参数名         | 类型      | 是否必须 | 备注                           |
| -------------- | ------ | -------- | ------------------------------ |
| userId           | number | 必须     | 用户ID |


响应样例

```json

{
    "code": 1,
    "msg": "success",
    "data": {
        "id": 101,
        "username": "nowcoder",
        "email": "test@nowcoder.com",
        "headerUrl": "http://images.nowcoder.com/head/101.png",
        "createTime": "2019-05-05T19:37:53",
        "postCount": 12,
        "commentCount": 34,
        "likeCount": 56
    }
}
```


### 4.2 修改账号设置

#### 4.2.1 上传头像

> 请求路径：/users/avatar/{id}
> 
> 请求方式：POST
> 
>接口描述：上传并更新当前用户的头像图片

请求参数

参数格式：application/json

| 参数名         | 类型      | 是否必须 | 备注                           |
| -------------- | ------ | -------- | ------------------------------ |
| id           | number | 必须     | 用户ID |
| file           | file | 必须     | 头像图片文件（支持 jpg/png） |


请求样例
POST /users/101/avatar
Content-Type: multipart/form-data
file=@avatar.png


响应样例

```json

{
  "code": 1,
  "msg": "头像上传成功",
  "data": {
      "headerUrl": "http://images.nowcoder.com/head/101_avatar.png"
  }
}
```

#### 4.2.2 修改密码

> 请求路径：/users/password/{id}
> 
> 请求方式：PUT
> 
> 接口描述：用户输入原始密码、新密码、确认新密码，修改登录密码。

请求参数

参数格式：application/json
| 参数名         | 类型      | 是否必须 | 备注                           |
| -------------- | ------ | -------- | ------------------------------ |
| id           | number | 必须     | 用户ID |
| oldPassword           | string | 必须     |原始密码 |
| newPassword           | string | 必须     | 新密码 |
| confirmPwd           | string | 必须     |确认密码 |


请求样例

```json

{
  "oldPassword": "12345678",
  "newPassword": "newpassword123",
  "confirmPwd": "newpassword123"
}
```

响应样例

成功

```json

{
  "code": 1,
  "msg": "密码修改成功，请重新登录",
  "data": null
}
```

失败（原始密码错误）
```json

{
  "code": 0,
  "msg": "原密码错误",
  "data": null
}
```

失败（两次新密码不一致）
```json

{
  "code": 0,
  "msg": "两次输入的新密码不一致",
  "data": null
}
```

### 4.3 退出登录

> 请求路径：/users/logout
> 
> 请求方式：POST
> 
> 接口描述：退出登录，更新登录凭证状态为无效

请求参数
| 参数名         | 类型      | 是否必须 | 备注                           |
| -------------- | ------ | -------- | ------------------------------ |
| id           | number | 必须     | 用户ID |
| ticket           | string | 必须     | 登录凭证(ticket) |


请求样例

```json

{
    "id": 101,
    "ticket": "abccdefg12345"
}
```

响应样例

```json

{
    "code": 1,
    "msg": "退出成功",
    "data": null
}
```


